<div class="popover" style="position:absolute;top:0;right:0;left:auto;display:block">
    <div class="popover-inner" style="width:300px">
        <a style="cursor:pointer;margin:2px 5px 0 0" class="close">Ã—</a>
        <h3 class="popover-title"><%= @model.title %></h3>
        <div class="popover-content">
            <h4>Orthologue genes</h4>
            <div class="values">
                <% for match in @model.matches: %>
                    <% if match.symbol or match.primaryIdentifier: %>
                        <span><%= match.symbol or match.primaryIdentifier %></span>
                    <% else: %>
                        <span class="icon-warning-sign" title="No symbol or database identifier!"></span>
                    <% end %>
                <% end %>
            </div>
            <!-- individual dataset overlap constructed purely in a template -->
            <% for dataSet, homologues of @model.model.homologue.dataSets: %> 
                <!-- is it me? -->
                <% if @model.dataSet isnt dataSet: %>
                    <!-- too much logic? -->
                    <% intersection = ((a, b) -> v for v in a when v in b)(_.pluck(homologues, 'primaryIdentifier'), _.pluck(@model.matches, 'primaryIdentifier')) %>
                    <% if intersection.length > 0: %>
                        <h4>Overlap with <%= dataSet %></h4>
                        <div class="values">
                            <% for match in intersection: %>
                                <% obj = _(@model.matches).filter( (obj) -> obj.primaryIdentifier is match )[0] %>
                                <span><%= obj.symbol or obj.primaryIdentifier %></span>
                            <% end %>
                        </div>
                    <% end %>
                <% end %>
            <% end %>
        </div>
    </div>
</div>